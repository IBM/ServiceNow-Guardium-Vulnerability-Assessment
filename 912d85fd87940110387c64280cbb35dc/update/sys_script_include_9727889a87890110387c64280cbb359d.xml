<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_ibmrt_guard.GuardiumIntegrationManagedUnit</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description>IBM Guardium managed unit synchronization script</description>
        <name>GuardiumIntegrationManagedUnit</name>
        <script><![CDATA[var GuardiumIntegrationManagedUnit = Class.create();
GuardiumIntegrationManagedUnit.prototype =
    Object.extendsObject(GuardiumIntegrationBase, {

        retrieveGuardiumData: function(gAPI) {

            // get all managed units
            var responseMU = gAPI.get("managed_units", {
                "verbose": "1"
            });

            // attempt to get this CM's information
            try {
                var responseCM = gAPI.get('unit_data');
                if (responseCM && responseCM.data) {
                    // convert and add this CM to the list of Guardium nodes
                    responseMU.data.push(this.transform(responseCM.data));
                }
            } catch (errAPI) {
                // Call failed.  It could be an older version. Push the CM onto the list
                responseMU.data.push({
                    "Unit Host": gAPI.cm.fqdn,
                    "Type": responseMU.data.length > 0 ? "Manager" : "Collector",
					"online": true
                });
            }

            return responseMU;
        },

        transform: function(unit_data) {
            // Unit data members are slightly different than Unit_type members
            return {
                "Unit Host": unit_data['Unit Host'],
                "IP": unit_data['IP'],
                "Type": unit_data['Unit Type'],
                "IP Mode": unit_data['IP Mode'],
                "Version": unit_data['Version'],
                "online": true
            };
        },

        type: 'GuardiumIntegrationManagedUnit'
    });]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-01-16 13:04:43</sys_created_on>
        <sys_id>9727889a87890110387c64280cbb359d</sys_id>
        <sys_mod_count>32</sys_mod_count>
        <sys_name>GuardiumIntegrationManagedUnit</sys_name>
        <sys_package display_value="IBM Guardium Vulnerability Assessment" source="x_ibmrt_guard">912d85fd87940110387c64280cbb35dc</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="IBM Guardium Vulnerability Assessment">912d85fd87940110387c64280cbb35dc</sys_scope>
        <sys_update_name>sys_script_include_9727889a87890110387c64280cbb359d</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-05-24 13:46:32</sys_updated_on>
    </sys_script_include>
</record_update>
