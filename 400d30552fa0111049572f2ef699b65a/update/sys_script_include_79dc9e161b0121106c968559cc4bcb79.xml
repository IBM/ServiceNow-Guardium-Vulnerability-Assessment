<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_ibmrt_gdpva.GuardiumScanner</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description>Handles scan requests</description>
        <name>GuardiumScanner</name>
        <script><![CDATA[var GuardiumScanner = Class.create();
GuardiumScanner.prototype = Object.extendsObject(sn_vul.VulnerabilityScannerBase, {

	// handle scan request
	processScan: function(gr_sn_vul_scan) {
		// 1. determine which data source is affected
		// 2. find datasource in assessment test
		// 3. run assessment test
		// 3a. sn_vul_m2m_scan_source is created for me
		//     source = contains a single VulnerableItem sys_id value
		//     sn_vul_scan = contains gr_sn_vul_scan.sys_id
		// 4. change scan "state" to: "scanning"
		// 5. sync results
		// 6. change scan "state" to: "complete" | "error" | "canceled"
		//    status_message: "string"
		/*
			cmdb_ci (list of databases)
			vulnerability (3rd party test def)
			integration_run
			integration_instance: fe68413887c64110387c64280cbb3593
		*/
		return;
	},

    type: 'GuardiumScanner'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2023-02-18 16:23:00</sys_created_on>
        <sys_id>79dc9e161b0121106c968559cc4bcb79</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>GuardiumScanner</sys_name>
        <sys_package display_value="IBM Guardium Data Protection" source="x_ibmrt_gdpva">400d30552fa0111049572f2ef699b65a</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="IBM Guardium Data Protection">400d30552fa0111049572f2ef699b65a</sys_scope>
        <sys_update_name>sys_script_include_79dc9e161b0121106c968559cc4bcb79</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2023-02-18 17:01:27</sys_updated_on>
    </sys_script_include>
</record_update>
