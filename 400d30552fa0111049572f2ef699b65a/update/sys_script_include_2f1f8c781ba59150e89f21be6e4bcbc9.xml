<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_ibmrt_gdpva.GuardiumLog</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description>Similar to the system application log, this table records all actions performed by the IBM Guardium Vulnerability Assessment application.</description>
        <name>GuardiumLog</name>
        <script><![CDATA[var GuardiumLog = {

	debug: function(message, source, detail) {
		GuardiumLog.log('-1', message, source, detail);
	},
	
	info: function(message, source, detail) {
		GuardiumLog.log('0', message, source, detail);
	},
	
	warn: function(message, source, detail) {
		GuardiumLog.log('1', message, source, detail);
	},
	
	error: function(message, source, detail) {
		GuardiumLog.log('2', message, source, detail);
	},
		
	log: function(level, message, source, detail) {

		var gr = new GlideRecord('x_ibmrt_gdpva_log');
		gr.initialize();
		gr.setValue('level', level || '0');
		gr.setValue('source', source || '');

		var m = message || '';
		if (m) m+='\n';

		var d = detail || '';
		if ("object" == typeof d) {
			m += d.message + '\n';
			if (d.stack) {
				d = d.stack;
			} else {
				d = JSON.stringify(d);
			}
		}
		if (d) m+= d;
		gr.setValue('message', m);
		
		gr.insert();
	},

    type: 'GuardiumLog'
};]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-08-23 14:38:09</sys_created_on>
        <sys_id>2f1f8c781ba59150e89f21be6e4bcbc9</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>GuardiumLog</sys_name>
        <sys_package display_value="IBM Guardium Vulnerability Assessment" source="x_ibmrt_gdpva">400d30552fa0111049572f2ef699b65a</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="IBM Guardium Vulnerability Assessment">400d30552fa0111049572f2ef699b65a</sys_scope>
        <sys_update_name>sys_script_include_2f1f8c781ba59150e89f21be6e4bcbc9</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2022-08-26 18:33:22</sys_updated_on>
    </sys_script_include>
</record_update>
