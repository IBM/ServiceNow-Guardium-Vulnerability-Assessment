<details open="open">
  <summary><b>Table of contents</b></summary>

  - [Introduction](#introduction)
  - [Requirements](#requirements)
  - [Impact Statement Summary](#impact-statement-summary)
  - [Scenarios and Use Cases](#scenarios-and-use-cases)
  - [Architecture](#architecture)
  - [UI Interfaces](#ui-interfaces)
  - [ServiceNow Properties](#servicenow-properties)
  - [Security Model](#security-model)
  - [Performance Considerations](#performance-considerations)
  - [Licensing](#licensing)
  - [Contributing](CONTRIBUTING.md)
  - [Open Issues](issues)
  - [Support](issues/new/choose)

</details>

<hr/>

# Design Document

## Introduction

ServiceNow modules, **Vulnerability Response** and **Configuration Compliance**, are closely related to the IBM Guardium Vulnerability Assessment (VA) application. IBM Guardium customers have requested a certified ServiceNow "plug-in", available via the ServiceNow Store, that will synchronize Guardium VA data with ServiceNow to facilitate centralized management and tracking of database vulnerabilities.

## Requirements

### IBM Guardium
- IBM Guardium 11.4 + Patch 441 (available in August 2022) (Patch 460 will add CVSS Attack Vector) or IBM Guardium 11.5 (with latest patch to add CVSS Attack Vector)
- IBM Guardium user with Guardium "vulnerability-access" role (or Guardium "admin" role) 
- Add "vulnerability-access" role to all existing Guardium data sources to permit the ServiceNow plug-in the ability to update and delete existing data sources which result from changes to ServiceNow CMDB

### ServiceNow
- Tested on ServiceNow releases: Rome, San Diego, Tokyo 
- [ServiceNow Vulnerability Response](https://www.servicenow.com/products/vulnerability-response.html) module
- [ServiceNow Configuration Compliance](https://www.servicenow.com/content/dam/servicenow-assets/public/en-us/doc-type/resource-center/data-sheet/ds-security-operations.pdf) module (optional but highly recommended)

### Install This Plug-in
- You can install this plug-in in one of three ways:
  1. From ServiceNow Store as a certified app (coming soon!)
  2. Import from source control (this entire github project)
  3. Update Set: follow instructions in <a href="INSTALLATION-and-TEST.md">Installation and Test document</a>

## Impact Statement Summary

- I want to aggregate and view vulnerabity scan results in ServiceNow
- I want to track database changes for vulnerabily issues in ServiceNow
- I want to initiate vulnerabity scans from ServiceNow


### Business impact

- Integrating IBM Guardium with ServiceNow lets customers enjoy power of ServiceNow's workflow with IBM Guardium's ability to scan, discover, and monitor databases


#### Intiative / Epic link

- [GRD-57828: Integration Application for Guardium in ServiceNow for VA content](https://jira.rtp.raleigh.ibm.com:8443/browse/GRD-57828)


### Technical impact

The "plug-in" on ServiceNow will:
- Provide synchronization of Guardium data source records with ServiceNow data source records. An attempt will be made to find a matching CI (cmdb_ci_db_instance) using a predefined CI Lookup Rule (sn_sec_cmn_ci_lookup_rule)
- Provide synchronization of Guardium data source groups
- Import Guardium Managed Units (Collectors and Aggregators) into ServiceNow Guardium Server (`x_ibmrt_gdpva_server`) entries
- Import Guardium vulnerability tests into ServiceNow as Third Party Vulnerability (`sn_vul_third_party_entry`) and Configuration Compliance Test (`sn_vulc_test`) entries 
- Import Guardium test result summary data into ServiceNow Guardium Test Result Summary (`x_ibmrt_gdpva_test_result_summary`) 
- Import Guardium test result details into ServiceNow as Vulnerable Item Detection (`sn_vul_detection`) and Configuration Compliance Test Result (`sn_vulc_result`) entries 
- Link the Vulnerable Item Detection (`sn_vul_detection`) to the Third Party Test (`sn_vul_third_party_entry`) performed and to the affected Database Instance (`cmdb_ci_db_instance`)
- Link the Configuration Compliance Test Result (`sn_vulc_result`) to the Configuration Compliance Test (`sn_vulc_test`) performed and to the affected Database Instance (`cmdb_ci_db_instance`)
- Provide synchronization of Guardium Test Exceptions
- Import Guardium Assessment Tests (a group of vulnerability tests that run on a group of data sources) which can be triggered manually by ServiceNow UI  
- Run selected Assessment Test on selected Managed Unit (Collector)


## Scenarios and Use Cases

**Release v1.2.x Scenarios:**
- I can view Guardium vulnerability assessment results within ServiceNow Vulnerabilty Response and Configuration Compliance modules
- I can adjust ServiceNow scheduled jobs (IBM Guardium > **Integrations**) to synchronize Guardium data with ServiceNow data and can run scheduled job on demand (`Execute Now`)
- I can create a **Test Exception**, rerun Assessment Test, synchronize Test Result Details, and see an open Vulnerable Item (`sn_vul_vulnerable_item`) automatically closed due to the Test Exception
- I can run **Assessment Test** from ServiceNow UI to verify a fix for a failed Test Result
- I can adjust **Database Instance Transform Map** to align with any new ServiceNow Database Instance classes and properties
- I can adjust **Database Catalog Transform Map** to align with any new ServiceNow Database Catalog classes and properties
- I can add a script in **Database Export** to modify the exported Database entry before being inserted into Guardium.  For example, it may be desired to add credentials to the Guardium Data Source
- I can adjust the default **CI Lookup Rule** to match Guardium data source entries to ServiceNow CMDB_CI entries

## Architecture

<a name="architecture-overview">**Overview**</a>

**Security Integration**
<div style="padding-left: 2em;">

![](images/security-integrations.png)
</div>
<br/>

**Third-Party Vulnerability Integration**
<div style="padding-left: 2em;">

![](images/third-party-vulnerability-integration.png)
</div>
<br/>

**Vulnerability Integration - Scheduled jobs**
<div style="padding-left: 2em;">

![](images/scheduled-jobs.png)
</div>
<br/>

**Data Flow**
<div style="padding-left: 2em;">

![](images/vr-data-flow.png)
</div>
<br/>

---

<a name="architecture-managed-units">**Managed Units**</a>

- "Managed Units" are IBM Guardium application servers often called Collectors and Aggregators.  These records will be inserted into a new ServiceNow Guardium Servers (`x_ibmrt_gdpva_server`) table.
- Guardium REST-API: restAPI/_managed\_units_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any {brace notation} represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Field |
| --- | --- |
| Unit Host | Name (string) |
| Unit Host | Fully Qualified Domain Name (string) |
| IP Address | IP Address (string) |
| Type - IP Mode | IP Mode (string) |
| Type - Unit Type | Unit Type (string) |
| Version | Version (string) |
| online | Online (boolean) |
| {Central Manager} | Central Manager (reference) |
</div>

<br/>

---

<a name="architecture-databases">**Guardium Data Sources**</a>

- **Guardium Data Source Records** 
  - Synchronized with ServiceNow Guardium Data Source (`x_ibmrt_gdpva_datasource`) records
  - Guardium REST-API: restAPI/online_report?reportName=_Data Sources_
  - The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Field |
| --- | --- |
| Datasource Name | Name (string) |
| Host | Fully Qualified Domain Name (string) |
| Port | TCP Port (string) |
| Connection Properties | Attributes (string) |
| Database Name | Database Name (string) |
| Service Name | Service Name (string) |
| Datasource Id | Datasource ID (string) |
| Datasource Type | Datasource Type (string) |
| User Name | User (string) |
| Password | (string) |
| Status | Status (string) |
| Last Checked | Status Date (date) |
| Last Checked Message | Status Detail (string) |
| {related Discovered Item} | Discovered Item (reference) |
| {related DB Instance or DB Catalog} | Database Configuration Item (reference) |
| {Central Manager} | Central Manager (reference) |
</div>

  - **Database Instance and Catalog Matching**
    - If there are existing Guardium data sources upon synchronization with ServiceNow, the application will make best effort to match the Guardium data source with a ServiceNow Database Instance or Database Catalog.  FQDN, TCP Port, and information from **ServiceNow Database Instance Transform Map** will be used to link to the appropriate ServiceNow Database Instance or Catalog.  For example, Oracle `database_name` and `sid` fields, along with Oracle instance class (`ci_cmdb_db_ora_instance`), the FQDN, and TCP Port are used to match with an existing ServiceNow Database Instance entry.
    - If a match is found, the existing Database Catalog (linked to Database Instance) will be added to the Guardium data source record so that it can be referenced in Configuration Compliance Test Result (CTR) and Vulnerable Item (VIT) entries
    - If no match is found (a database exists in Guardium but not in ServiceNow CMDB), a record is created in the Discovered CI (`sn_sec_cmn_src_ci`) table or, optionally, in the Database Instance (`cmdb_ci_db_instance`) table to ensure Vulnerable Item (VIT) and Configuration Compliance (CTR) records can be linked to the appropriate CI. This new record will be referenced in ServiceNow Configuration Compliance Test Result (`sn_vulc_result`) and Vulnerable Item (`sn_vul_vulnerable_item`) entries.

<br/>

- **Database Instance Transform Maps** 
  - A new ServiceNow table, Database Instance Transform Maps (`x_ibmrt_gdpva_db_instance_transform_map`), enhances matching of supported Guardium database types to ServiceNow Database Instance classes and provides custom mapping of DB Instance fields to Guardium Data Source.
  - Used in import of Guardium data sources and export of ServiceNow Database Instances
  - The Database Instance classes shown below are the ones supported by ServiceNow as of "Rome" release and are in common with supported Guardium database types

<div style="padding-left: 2em;">

| Database Type | Database Instance Class | Database Instance Field for "Guardium Database" | Database Instance Field for "Guardium Server" |
| --- | --- | --- | --- |
| CLOUDERA MANAGER | cmdb_ci_cloud_database | object_id | - |
| DATASTAX CASSANDRA | cmdb_ci_cassandra_instance | - | - |
| DB2, DB2 FOR i, DB2 z-OS | cmdb_ci_db_db2_instance | - | db_name |
| GREENPLUMDB | cmdb_ci_db_postgresql_instance | instance | - |
| INFORMIX | cmdb_ci_db_informix_instance | database | - |
| MARIADB | cmdb_ci_db_mysql_instance | data_directory | - |
| MONGODB | cmdb_ci_db_mongodb_instance | - | - |
| MS SQL SERVER | cmdb_ci_db_mssql_instance | database | instance_name |
| MYSQL | cmdb_ci_db_mysql_instance | data_directory | - |
| ORACLE | cmdb_ci_db_ora_instance | database_name | sid |
| PERCONA MYSQL | cmdb_ci_db_mysql_instance | data_directory | - |
| POSTGRESQL | cmdb_ci_db_postgresql_instance | instance | - |
| SYBASE | cmdb_ci_db_syb_instance | instance | - |
| SYBASE IQ | cmdb_ci_db_syb_instance | instance | - |
| - All other data source types - | cmdb_ci_db_instance | - | - |
</div>

<br/>

- **Database Catalog Transform Maps** 
  - A new ServiceNow table, Database Catalog Transform Maps (`x_ibmrt_gdpva_db_catalog_transform_map`), allows customizable mapping of DB Catalog fields to Guardium Data Source.
  - Used in import of Guardium data sources and export of ServiceNow Database Catalogs that are linked to Database Instances
  - The catalogs shown below are the ones supported by ServiceNow as of "San Diego" release and are in common with supported Guardium database types

<div style="padding-left: 2em;">

| Database Type | Database Catalog Class | Database Catalog Field for "Guardium Database" | Database Catalog Field for "Guardium Server" |
| --- | --- | --- | --- |
| COUCHBASE | cmdb_ci_couchbase_bucket | name | - |
| DATASTAX CASSANDRA | cmdb_ci_cassandra_keyspace | name | - |
| DB2, DB2 FOR i, DB2 z/OS | cmdb_ci_db_db2_catalog | - | name |
| MONGODB | cmdb_ci_mongo_database | database_name | - |
| MS SQL SERVER | cmdb_ci_db_mssql_catalog | name | - |
| MYSQL | cmdb_ci_db_mysql_catalog | name | - |
| ORACLE | cmdb_ci_db_ora_catalog | name | schema |
| POSTGRESQL | cmdb_ci_postgresql_schema |name | - |
| SYBASE | cmdb_ci_db_syb_catalog | name | - |
| - All other data source types - | cmdb_ci_db_catalog | name | - |
</div>

<br/>

- **Database Export** 
  - A new ServiceNow table, Database Export (`x_ibmrt_gdpva_database_export_target`), allows customization of the exported Database Instance or Database Catalog record that is about to be inserted into Guardium
  - For example, JavaScript code could be added to append credentials to an exported data source record since Guardium requires valid credentials to test, discover, and monitor the data source

<br/>

---

<a name="architecture-database-groups">**Guardium Data Source Groups**</a>

- Guardium Data Source Groups will be synchronized to new ServiceNow Data Source Group table (`x_ibmrt_gdpva_datasource_group`).
- Static data source members will be synchronized to new ServiceNow Data Source Group Member table (`ibm_guard_datasource_group_member`)
- Guardium REST-API: restAPI/_datasource\_group_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Data Source Group Field |
| --- | --- |
| appTypeCriteria | Application Type (string) |
| dbTypeCriteria | Database Type (list) |
| groupName | Name (string) |
| groupType | Type (choice) |
</div>

<br/>

---

<a name="architecture-vulnerability-tests">**Guardium Vulnerability Tests**</a>

- Guardium tests will be imported into SericeNow Third-Party Vulnerability Test (`sn_vul_third_party_entry`) and Configuration Compliance Test (`sn_vulc_test`) entries
- Guardium REST-API: restAPI/online_report?reportName=_Available VA tests - detailed_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Third-Party Vulnerability Test Field |
| --- | --- |
| Test Description | name, id |
| Test Type | classification |
| Category Name | category |
| Severity | normalized_severity, source_severity |
| STIG Severity | stig_severity |
| Datasource Type | product |
| Short Description | summary |
| CVE reference | cve_id |
| "IBM Guardium" | source |
| integrationGr.sys_id | source_instance |

<br/>

| Guardium Vulnerability Test Field | ServiceNow Configuration Compliance Test Field |
| --- | --- |
| Test Description | short_description, source_id |
| Test Type | source_sub_category |
| Category Name | source_category |
| Severity | source_criticality |
| STIG Severity | stig_severity |
| Timestamp | source_created |
| "IBM Guardium" | source |
</div>

<br/>

---

<a name="architecture-assessment-tests">**Guardium Assessment Tests**</a>

- Guardium Assessment Tests are imported into a new ServiceNow table (`x_ibmrt_gdpva_assessment_test`)
- **Last Scan Rating** and **Last Scan Date** are populated by Guardium Test Result Summary data
- Guardium REST-API: restAPI/_assessment\_test_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Assessment Tests Field |
| --- | --- |
| Assessment ID | ID (string) |
| Assessment Name | Name (string) |
| {Test Result Summary > Scan Rating} | Last Scan Rating (string) |
| {Test Result Summary > Scan Date} | Last Scan Date (date) |
| {Test Result Summary > Node that last ran the assessment} | Guardium Server (reference) |
| {Central Manager} | Central Manager (reference) |
</div>

<br/>

---

<a name="architecture-test-results">**Guardium Test Results**</a>

- Assessment **Test Result Summary** entries are imported into a new ServiceNow table (`x_ibmrt_gdpva_test_result_summary`)
- The summary information is used in the **Test Result Dashboard**
- Guardium REST-API: restAPI/online_report?reportName=_Assessment summary_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Test Result Summary |
| --- | --- |
| Assessment Description | name (string) |
| Execution Date | last_scan_date (date) |
| Overall Score | last_scan_rating (integer) |
| Recommendation | recommendation (string) |
| {Total # of CIS failures} | cis_flaw_count (integer) |
| {Total # of CVE failures} | cve_flaw_count (integer) |
| {Total # of STIG failures} | stig_flaw_count (integer) |
| {Total # of failures} | detected_flaw_count (integer) |
| {Central Manager} | Central Manager (reference) |
</div>

- Assessment **Test Result Details** are imported into Vulnerable Item (`sn_vul_vulnerable_item`) and Configuration Compliance Test Result (`sn_vulc_result`) depending on the **Configuration Preference** field: Test failure type (`test_failure_type`)
  - (APAR) Authorized programming analysis report
  - (CAS) Configuration Auditing System
  - (CIS) Center for Internet Security
  - (STIG) Security Technical Implementation Guide
  - CIS and STIG
  - (CVE) Common Vulnerabilities and Exposures
  - Guardium Test
  - Reference Manual
- The IBM plug-in makes use of ServiceNowâ€™s **sn_vul.DetectionBase** "Script Include" library which will record all incidents of a test result: pass, fail, deprecated, and error as ServiceNow Vulnerable Item Detections (`sn_vul_detection`).  If the failed test meets the preferred severities, the DetectionBase script will open a ServiceNow **Vulnerable Item** (`sn_vul_vulnerable_item`) record.  If the test failed but does not match preferred severities, any open Vulnerable Item (`sn_vul_vulnerable_item`) will be closed with a "proof" that the severity does not meet preferences.
- The IBM plug-in also makes use of ServiceNow's **sn_vulc.ComplianceTestResult** "Script Include" library, if available, which will record all incidents of a test result: pass, fail, deprecated, and error as ServiceNow Configuration Compliance **Test Results** (`sn_vulc_result`)
- Guardium REST-API: restAPI/online_report?reportName=_Security Assessment Export_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Vulnerable Item Field |
| --- | --- |
| {true} | confirmed |
| {matched DB Instance} | cmdb_ci |
| {sn_sec_int_integration.sys_id} | integration_instance |
| {sn_sec_int_integration_run.sys_id} | integration_run |
| Execution Date | last_found |
| Result Text | proof |
| Severity | severity |
| Recommendation | solution_summary |
| {"IBM Guardium"} | source |
| Score Description | source_status |
| Category | source_type |
| {matched Disc Item} | src_ci |
| {0 == Fail, 1 == Pass} | status |
| Test Description | test_name |
| {1} | times_found |
| {matched 3rd Party Test} | vulnerability |

<br/>

| Guardium Test Result Field | ServiceNow Configuration Compliance Test Result Field |
| --- | --- |
| {true} | confirmed |
| {matched Configuration Compliance Test} | control |
| {matched DB Instance} | cmdb_ci |
| Result Text | description |
| Test Description | display |
| {sn_sec_int_integration.sys_id} | integration_instance |
| Execution Date | last_seen |
| Recommendation | remediation |
| Score Description | result |
| Severity | severity |
| {"IBM Guardium"} | source |
| {matched Disc Item} | src_ci |
</div>

<br/>

---

<a name="architecture-test-exceptions">**Test Exceptions**</a>

- There are cases where an database administrator might wish to temporarly allow a failing vulnerability test.  In these cases, the database administrator will create a _Test Exception_ record for the specific test on all or selected Data Sources.

- The Test Exception record must specify:
  - The ServiceNow Third-Party Vulnerability Test
  - The Guardium Assessment Test
  - The Guardium Data Source or Data Source Group
  - "From" date which must be greater than "now"
  - "To" date which must be greater than "From" date

- Guardium Test Exceptions are two-way synchronized with ServiceNow table (`x_ibmrt_gdpva_test_exception`)
- Changes made to Test Exceptions in ServiceNow are immediately sent to Guardium.
- Guardium REST-API: restAPI/_test\_exception_
- The IBM Guardium Field in the table below represents the data received from the Guardium REST-API response.  Any brace notation represents a calculated value.

<div style="padding-left: 2em;">

| IBM Guardium Field | ServiceNow Test Exception Field |
| --- | --- |
| testExceptionsId | id |
| assessmentDesc | assessment_description |
| assessmentScope | assessment_scope |
| datasourceScope | datasource_scope |
| Approver | approved_by |
| explanation | explanation |
| datasourceGroup | database_group |
| fromDate | valid_from |
| toDate | valid_to |
| {cve_lookup_entry} | test_reference |
| {cmdb_ci_lookup_entry} | database_instance_reference |
</div>

**Guardium Test Exception Example**

<div style="padding-left: 2em;">

![](images/test-exception.png)
</div>

<br/>

---


## UI Interfaces

**IBM Guardium > Test Result Dashboard:**

- Last 30 days test results summary
- Last 30 days total CIS test failures
- Last 30 days total CVE test failures
- Last 30 days total STIG test failures

**IBM Guardium > Configuration Preferences**

- Log Level: control the amount of data sent to "Application Log"
- REST-API Page Size: control amount of data requested from Guardium
- Database Import
  - Monitor: can be set on database instance, if allowed to create a database instance
  - When a database is discovered: how to handle a Guardium data source that cannot be matched to a ServiceNow Database Instance
- Database Export
  - See **Database Export**, **Database Instance Transform Maps**, and **Database Catalog Transform Maps** for controlling how a ServiceNow database instance is exported to IBM Guardium
- Test Result Import
  - Test failure severity: controls what test results go to ServiceNow Vulnerability Response and ServiceNow Configuration Compliance
  - Test failure type: control the amount of test failures to record in Vulnerability Response  
  - Number of days: control number of previous days of test results to fetch on first synchronization 

**ServiceNow Tables Inserted By Plug-in:**

- IBM Guardium Assessment Test (`x_ibmrt_gdpva_assessment_test`)
- IBM Guardium Central Manager (`x_ibmrt_gdpva_central_manager`)
- IBM Guardium Data Source (`x_ibmrt_gdpva_datasource`)
- IBM Guardium Data Source Group (`x_ibmrt_gdpva_datasource_group`)
- IBM Guardium Data Source Group Member (`x_ibmrt_gdpva_datasource_group_member`)
- IBM Guardium Database Catalog Transform Map (`x_ibmrt_gdpva_db_catalog_transform_map`)
- IBM Guardium Database Export (`x_ibmrt_gdpva_database_export_target`)
- IBM Guardium Database Instance Transform Map (`x_ibmrt_gdpva_db_instance_transform_map`)
- IBM Guardium Preference (`x_ibmrt_gdpva_preference`)
- IBM Guardium Server (`x_ibmrt_gdpva_server`)
- IBM Guardium Test Exception (`x_ibmrt_gdpva_test_exception`)
- IBM Guardium Test Result Summary (`x_ibmrt_gdpva_test_result_summary`)
- IBM Guardium Vulnerability Integration (`x_ibmrt_gdpva_vul_integration`)

**Modified Tables:**

- None

**Actions:**

- **Export Database to Guardium** 
  - It may be desired to export selected database entries to a different Guardium Central Managers
  - ServiceNow Database Instance record will be linked to corresponding Guardium Data Source entry
  - Field mapping is the same as the above <a href="#architecture-databases">Guardium Data Sources</a> field map
  - Database Export (`x_ibmrt_gdpva_database_export_target`) script can be defined to process the exported Database Instance or Database Catalog entry before being inserted into or updated in Guardium
  - A Business Rule monitors for any new or changed Database Instance.  The Database Instance will be immediately synchronized with the Guardium Central Manager chosen as the default in Preferences

- **Run Assessment Test**
  - Run selected Assessment Test on specified Managed Unit (Collector)
  

<br/>

## ServiceNow Properties
Properties used by the application and their use

| Property | Default | Usage |
| --- | --- | --- |
| x_ibmrt_gdpva.ci_lookup_enabled | true | Controls whether CI Lookup Rules are utilized on Data Source import into ServiceNow |
| x_ibmrt_gdpva.queue.wait_for_running_jobs | true | On Daily Synchronization, wait for running Assessment Test jobs to complete before importing the results into ServiceNow |
| x_ibmrt_gdpva.queue.max_attempts | 200 | Some import jobs depend on others to complete first. When multiplied by 3 minutes, this value represents the maximum time to wait on other jobs to complete. |
| glide.http.outbound.max_timeout | 30 seconds | Maximum time MID Server will wait for IBM Guardium to respond to a REST-API request. It is recommended to set this value to 300. |
| glide.http.outbound.max_timeout.enabled | false | It is recommended to set this value to true. |

<br/>

## Security model

- x_ibmrt_gdpva.admin > administrative tables and actions
- x_ibmrt_gdpva.user  > user tables and actions
- IBM Guardium user with at least role: `vulnerability-assess`
- IBM Guardium client ID and client secret
- Oauth 2.0 authentication with IBM Guardium

### ACL

- Custom tables and role access

<div style="padding-left: 2em;">

| TABLE | ROLE |
| --- | --- |
| IBM Guardium Assessment Test (`x_ibmrt_gdpva_assessment_test`) | x_ibmrt_gdpva.user |
| IBM Guardium Central Manager (`x_ibmrt_gdpva_central_manager`) | x_ibmrt_gdpva.admin |
| IBM Guardium Data Source (`x_ibmrt_gdpva_datasource`) | x_ibmrt_gdpva.user |
| IBM Guardium Data Source Group (`x_ibmrt_gdpva_datasource_group`) | x_ibmrt_gdpva.user |
| IBM Guardium Data Source Group Member (`x_ibmrt_gdpva_datasource_group_member`) | x_ibmrt_gdpva.user |
| IBM Guardium Database Catalog Transform Map (`x_ibmrt_gdpva_db_catalog_transform_map`) | x_ibmrt_gdpva.admin |
| IBM Guardium Database Export (`x_ibmrt_gdpva_database_export_target`) | x_ibmrt_gdpva.admin |
| IBM Guardium Database Instance Transform Map (`x_ibmrt_gdpva_db_instance_transform_map`) | x_ibmrt_gdpva.admin |
| IBM Guardium Preference (`x_ibmrt_gdpva_preference`) | x_ibmrt_gdpva.admin |
| IBM Guardium Server (`x_ibmrt_gdpva_server`) | x_ibmrt_gdpva.user |
| IBM Guardium Test Exception (`x_ibmrt_gdpva_test_exception`) | x_ibmrt_gdpva.user |
| IBM Guardium Test Result Summary (`x_ibmrt_gdpva_test_result_summary`) | x_ibmrt_gdpva.user |
| IBM Guardium Vulnerability Integration (`x_ibmrt_gdpva_vul_integration`) | x_ibmrt_gdpva.admin |

</div>

### Audit Logs

- All important information is logged to _System Log > Application Logs_
- All errors are logged to _System Log > Errors_
- A preference setting (Verbose, Informational, Error) determines verboseness of the log


## Performance Considerations

- First time database synchronization may take a long time. The code retrieves 200 entries per page, by default.
- If there are more than 5,000 Data Source entries in IBM Guardium, IBM Guardium may be slow to respond to REST-API requests from ServiceNow.
- Set the following properties in ServiceNow to avoid any issue from a slow response:
<div style="padding-left: 2em;">

```
    glide.http.outbound.max_timeout=300
    glide.http.outbound.max_timeout.enabled=true
```

</div>

<br/>

## Licensing

[Project License](LICENSE)

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
